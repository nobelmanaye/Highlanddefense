!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},o=(new e.Error).stack;o&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[o]="2c95aebc-7f1b-47fe-a444-8cdb181ba4ea",e._sentryDebugIdIdentifier="sentry-dbid-2c95aebc-7f1b-47fe-a444-8cdb181ba4ea")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8984],{58984:function(e,o,t){t.d(o,{I:function(){return m}});var a=t(65122),r=t(69762),l=t(43186),i=t(52983),n=t(33961),_=t(51986);let s=(e,o)=>{let t=d(e,o),a=c(e);if(!t)throw Error("There are no download parameters for ".concat(e.name," in ").concat(o));return{action:t,modifier:a}},d=(e,o)=>{var t;let a=null===(t=u[e.name])||void 0===t?void 0:t[o];if(!a)throw Error("There are no download parameters for ".concat(e.name," in ").concat(o));return a},c=e=>{if("workflow"===e.name){let o=w[e.subOption];if(!o)throw Error("There are no download parameters for workflow with ".concat(e.subOption));return o}},u={retouch:{detail:"ai_tool_retouch",postDownload:"ai_tool_retouch_after_download"},expand:{detail:"ai_tool_expand",postDownload:"ai_tool_expand_after_download"},reimagine:{detail:"ai_tool_reimagine",postDownload:"ai_tool_reimagine_after_download"},adjust:{detail:"ai_tool_adjust",postDownload:"ai_tool_adjust_after_download",thumbnail:"ai_tool_adjust_thumbnail"},replacebg:{detail:"ai_tool_replacebg"},video:{detail:"ai_tool_video",postDownload:"ai_tool_video_after_download"},assistant:{detail:"ai_tool_assistant",thumbnail:"ai_tool_assistant_thumbnail"},generatePrompt:{detail:"ai_tool_generate_prompt"},styleReference:{detail:"ai_tool_generate_style_ref"},workflow:{detail:"ai_tool_assistant"},imageEditor:{thumbnail:"ai_tool_all_thumbnail",detail:"ai_tool_all"}},w={createSocialPost:"workflow_create_post",createPoster:"workflow_create_poster",mixImages:"workflow_mix_images",applyPromo:"workflow_apply_promo",createFlyer:"workflow_create_flyer",createLogoVariations:"workflow_create_logo_variations",localize:"workflow_localize",createLogo:"workflow_create_logo",applyColors:"workflow_apply_colors",replaceText:"workflow_replace_text",removeText:"workflow_remove_text",replaceElement:"workflow_replace_element",addElement:"workflow_add_element"};var p=t(75045);let f=e=>{let{tool:o,location:t,imageSrc:a,resource:r}=e,{id:d,name:c,author:u,premium:w,type:f,isAIGenerated:m,preview:g,url:b}=r,{action:h,modifier:k}=s(o,t),y=(0,_.M)({tool:o,resource:{type:f,subtype:f,authorName:u.name,isPremium:w,isAIGenerated:m}}),{handleDownload:v}=(0,p.i)({resource:{id:d,name:c,author:u,premium:w,regularType:f,isAIGenerated:m,url:b,preview:g,type:f},action:h,modifier:k,showAttributionModal:!1,skipDownloadTracker:!0,location:(0,n.d)({isResourcePremium:w,tool:o,location:t}),checkoutQueryParams:y}),T=(0,l.J)(),I=null!=a?a:g.url;return(0,i.useCallback)(async()=>{let e=await v(I);if(!(null==e?void 0:e.signedUrl))throw Error("Failed to download image");return T(),"".concat(e.signedUrl,"&w=2000&h=2000")},[I,v,T])},m=e=>{let{tool:o,location:t,imageSrc:l,extraParams:i,resource:n}=e,{id:_,premium:s,isAIGenerated:d,type:c,author:{name:u},name:w,preview:{url:p,width:m,height:g}}=n,b=(0,a.e)(),h=f({tool:o,location:t,imageSrc:l,resource:n});return(0,r.F)({tool:o,resource:{id:_,name:w,type:c,authorName:u,isPremium:s,isAIGenerated:d,groupedType:"regular",media:{url:p,width:m,height:g}},canDownloadResource:b||!s,imageSrc:l,getSignedResource:h,location:t,extraParams:i})}},15715:function(e,o,t){t.d(o,{H:function(){return r}});let a=e=>{let{resource:o,file:t,option:a,size:r,action:l,walletId:i,locale:n,modifier:_}=e,s=new URLSearchParams;return s.set("resource","".concat(o)),t&&a?(s.set("file",t),s.set("option","".concat(a))):r&&s.set("size","".concat(r)),l&&s.set("action",l),i&&s.set("walletId",i),s.set("locale",n),_&&s.set("modifier",_),s.toString()},r=async e=>{let o=a(e),t=await fetch("/api/regular/download?".concat(o));return t.ok?{success:!0,data:await t.json()}:429===t.status?{success:!1,data:"DOWNLOAD_LIMIT_REACHED",metadata:"/download-limit"}:401===t.status||403===t.status||405===t.status?{success:!1,data:"AUTHENTICATION_ERROR"}:404===t.status?{success:!1,data:"NOT_FOUND"}:{success:!1,data:"UNKNOWN_ERROR"}}},75045:function(e,o,t){t.d(o,{i:function(){return R}});var a=t(59445),r=t(15880),l=t(68147),i=t(85229),n=t(87420),_=t(59608),s=t(52983),d=t(9036),c=t(35576),u=t(7526);let w=(e,o)=>o||("photo"===e?"jpg":"zip");var p=t(24278);t(97458);let f=(0,s.createContext)(null),m=()=>(0,s.useContext)(f)||{shouldTrackingLog:!0};var g=t(15715),b=t(32509),h=t(59916),k=t(72118),y=t(1850),v=t(64979),T=t(56879);let I=y.z.enum(["download","copy","edit","prompt","preview","remove_background","remove_background_edit","ai_video",v.cm,v.PF,v.p3,v.Kq,v.wK,v.os,v.H$,v.C0,v.u4,v.OI,v.Iu,v.e5,"ai_tool_retouch","ai_tool_retouch_after_download","ai_tool_expand","ai_tool_expand_after_download","ai_tool_reimagine","ai_tool_reimagine_after_download","ai_tool_adjust","ai_tool_adjust_after_download","ai_tool_replacebg","ai_tool_video","ai_tool_video_after_download","ai_tool_assistant","ai_tool_generate_prompt","ai_tool_generate_style_ref","ai_tool_adjust_thumbnail","ai_tool_assistant_thumbnail","ai_tool_all_thumbnail","ai_tool_all"]),z=y.z.enum(["workflow_create_post","workflow_create_poster","workflow_mix_images","workflow_apply_promo","workflow_create_flyer","workflow_create_logo_variations","workflow_localize","workflow_create_logo","workflow_apply_colors","workflow_replace_text","workflow_remove_text","workflow_replace_element","workflow_add_element"]);y.z.object({resource:y.z.coerce.number(),file:T.ru.optional(),option:y.z.coerce.number().optional(),size:y.z.coerce.number().optional(),action:I.optional(),modifier:z.optional(),walletId:y.z.string().nullable().optional(),locale:y.z.string()}),y.z.object({data:y.z.object({filename:y.z.string(),url:y.z.string(),prompt:y.z.string().optional(),signed_url:y.z.string().optional()})}).transform(e=>{let{data:o}=e;return o}).transform(e=>{let{signed_url:o,...t}=e;return{...t,signedUrl:o}});let D=y.z.array(y.z.string()),N=new Date(new Date().getTime()+48e4),x=k.Z.withConverter({write:e=>e}),O=e=>{try{let o=x.get(e);if(!o)return[];return D.parse(JSON.parse(o))}catch(e){return[]}},E=()=>{let e=(0,l.I)(),o=(0,h.b)();return(0,s.useCallback)(t=>{if(!e)return;let a="".concat("ck_items_").concat(e),r=O(a),l="".concat(t);if(!r.includes(l)){let e=JSON.stringify([...r,l]);x.set(a,e,{path:"/",domain:o,expires:N})}},[e,o])},R=e=>{let{resource:o,file:t,action:f="download",modifier:h,location:k="resource_detail",option:y,size:v,showAttributionModal:T=!0,handleError:I,checkoutQueryParams:z,skipDownloadTracker:D=!1}=e,{id:N,name:x,author:O,premium:R,regularType:C,isAIGenerated:U,url:j,type:A}=o,[L,H]=(0,s.useState)(!1),{isUserWinback:P,showWinbackModal:F}=(0,i.l)(),{showAttribution:S}=(0,p.tc)(),W=E(),K=(0,b.b)({resource:o,location:k}),M=(0,c.mS)(),{shouldTrackingLog:G}=m(),{showDeviceBlockedModal:J,isDeviceBlocked:q}=(0,r.qx)(),Z=(0,a.Lh)(),$=(0,l.I)(),V=(0,n.ZK)(),B=(0,d.TH)({file_extension:w(C,t),file_name:x,file_id:N,license:R?"premium":"free",resolution:v?u.w8[v]:"original",style:"na",author_name:O.name,category:U?"ai_image":C,action:"prompt"===f?"view_prompt":f,location:k,url_link:j}),Q=(0,s.useCallback)(e=>{if(I){I(e);return}"prompt"!==f&&K(e,z)},[I,f,K,z]);return{handleDownload:(0,s.useCallback)(async(e,o)=>{if(q){J();return}if(P){F();return}H(!0),Z||_.uT("WARNING: User ".concat($," has no wallet_id"),"warning"),G&&!D&&M({resourceId:N,isResourcePremium:R,resourceType:A,downloadType:f,fileType:A,variant:k});let a=await (0,g.H)({resource:N,size:v?2e3:void 0,action:f,modifier:h,file:t,option:y,walletId:Z,locale:V});if(a.success)return T&&S&&S(),H(!1),W(N),B({externalUrl:null!=e?e:j,setting:o}),a.data;Q(a),H(!1)},[q,P,Z,G,D,N,v,f,h,t,y,V,Q,J,F,$,M,R,C,k,T,S,W,B,j]),isDownloading:L}}},32509:function(e,o,t){t.d(o,{b:function(){return n}});var a=t(17842),r=t(10893),l=t(52983),i=t(65724);let n=e=>{var o;let{location:t,resource:n}=null!=e?e:{},{t:_}=(0,r.$G)("error"),{openToast:s}=(0,a.x_)(),d=(0,i.W)(null!==(o=null==n?void 0:n.id)&&void 0!==o?o:0,"",t);return(0,l.useCallback)((e,o)=>{if("DOWNLOAD_LIMIT_REACHED"===e.data&&n){d({resourceData:{name:n.name,mediaUrl:n.preview.url,mediaWidth:n.preview.width,mediaHeight:n.preview.height,resourceType:"regular"},checkoutQueryParams:o,modalType:"downloadLimit",origin:"download_limit"});return}if("AUTHENTICATION_ERROR"===e.data){window.location.href="/oauth-logout";return}"NOT_FOUND"===e.data&&s({type:"danger",message:_("notFound")}),"UNKNOWN_ERROR"===e.data&&s({type:"danger",message:_("unknown")})},[d,s,n,_])}}}]);